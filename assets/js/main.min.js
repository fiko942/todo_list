const{ipcRenderer:a}=require("electron"),ipc=a;window.$=window.jQuery=require("jquery");let dataTemp;const el=a=>document.querySelector(a),elAll=a=>document.querySelectorAll(a);function showNotification(a="",b=""){let c=new bootstrap.Toast(document.querySelector("#live-toast"));$(".toast-title").text(a.trim()),$(".toast-message").text(b.trim()),$(".toast-container").css("cssText",`
            margin-left: 10px !important;
            margin-top: -10px !important;
        `),$("body, html").css("cssText",`
            overflow: hidden !important;
        `),c.show()}function addList(){ipc.send("add-list",$("#list-name-add").val().trim())}function randomString(d=1){let a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890____________",b="";for(let c=0;c<d;c++)b+=a[Math.floor(Math.random()*a.length)];return b}function deleteElementDeleteTask(){void 0!==$(".detail .delete")&&$(".detail .delete").remove()}function deleteTask(a,b){dataTemp=a,$("#confirm-delete-task").modal("show"),$("#confirm-delete-task #confirm-delete-task-message").text(`Are you sure to delete task: ${b} ?`)}function openTask(a){void 0!==$(".detail.nan")&&$(".detail.nan").removeClass("nan")}el(".nav .min").addEventListener("click",a=>{a.preventDefault(),ipc.send("minimize-app")}),el(".nav .max").addEventListener("click",a=>{a.preventDefault(),ipc.send("maximize-app")}),el(".nav .close").addEventListener("click",a=>{a.preventDefault(),ipc.send("close-app")}),$(".add-list-btn").on("click",a=>{$("#add-list").modal("show"),$(".modal-content").css("cssText",`
        box-shadow: 0px 0px 25px 3px #000;
    `),$(".modal-header").css("cssText",`
        border-bottom: none !important;
    `),$(".modal-footer").css("cssText",`
        border-top: none !important;
    `)}),$(".add-task").on("click",a=>{$("#add-task").modal("show"),$(".modal-content").css("cssText",`
        box-shadow: 0px 0px 25px 3px #000;
    `),$(".modal-header").css("cssText",`
        border-bottom: none !important;
    `),$(".modal-footer").css("cssText",`
        border-top: none !important;
    `)}),$("#list-name-add").on("keyup",a=>{13===a.keyCode&&addList()}),$("#submit-add-list").on("click",()=>{addList()}),ipc.on("message",(b,a)=>{showNotification(a[0],a[1])}),ipc.on("add-list-error",(b,a)=>{showNotification("Add list error",a),$("#add-list").modal("hide")}),ipc.on("add-list-complete",(a,b)=>{showNotification("Add list success","New list has been added successfully"),$("#add-list").modal("hide"),$("#list-name-add").val("")}),ipc.on("list-data",(e,b)=>{let d=document.querySelector(".task-item-container");d.innerHTML="";for(let a=b.length-1;a> -1;a--){let c=document.createElement("div");c.classList.add("task"),c.setAttribute("list-id",b[a].id),c.classList.add("d-flex"),c.setAttribute("task-id",b[a].id),c.innerHTML=`
            <i class='bx bxs-calendar-star icon' ></i>
            <span class="name">${b[a].name}</span>
            <button class="delete" id="delete-list" style="z-index: 9999999999999999999999" list-id="${b[a].id}" list-name="${b[a].name}"><i class='bx bx-trash' ></i></button>
            <span class="count"></span>
        `,a===b.length-1&&c.classList.add("active"),d.appendChild(c),document.querySelectorAll(".task-item-container .task").forEach(a=>{a.addEventListener("click",()=>{document.querySelectorAll(".task-item-container .task").forEach(a=>{a.classList.remove("active")}),a.classList.add("active");let b=a.hasAttribute("task-id")?a.getAttribute("task-id"):"";ipc.send("open-list",b),$(".tasks .head .t-name").text($(".task.active").text())})}),document.querySelectorAll("#delete-list[list-id][list-name]").forEach(a=>{a.addEventListener("click",()=>{var b={id:a.getAttribute("list-id"),name:a.getAttribute("list-name")};dataTemp=b,$("#confirm-delete-list-message").text(`Are you sure to delete list: ${b.name} ?`),$("#confirm-delete-list").modal("show")})})}$(".task-item-container .task")[0].click()}),$("#continue-delete-list").on("click",()=>{ipc.send("delete-list",dataTemp),$("#confirm-delete-list").modal("hide")}),$("#add-task form").on("submit",b=>{b.preventDefault();let a=$("#task-name-add").val().trim().replace("<","").replace(">","").replace(";",""),c=$("#task-date-add").val(),d=$("#task-time-add").val(),e=$("#task-note-add").val().trim().replace("<","").replace(">","").replace(";",""),f=$(".task.active").attr("list-id"),g=randomString(50);a.length<1?showNotification("Canceled","Enter name cahracters length more than 0"):a.length>60&&showNotification("Canceled","Enter name characters length less than 61");let h={name:a,date:c,time:d,note:e,list_id:f,task_id:g};ipc.send("add-task",h),$("#add-task").modal("hide"),$(".task.active").click()}),ipc.on("after-open-list",(e,a)=>{0===a.length&&($(".detail").addClass("nan"),$(".detail textarea").val(""),$(".detail .task-name").text(""),deleteElementDeleteTask());let d=document.querySelector(".tasks .data");if(void 0!==d){d.innerHTML="";for(let b=a.length-1;b> -1;b--){let c=document.createElement("div");c.classList.add("list"),c.setAttribute("task-id",a[b].task_id),c.innerHTML=`
                    <div class="title">${a[b].name}</div>
                    <div class="date"><i class='bx bx-calendar' ></i><span>${a[b].date}</span><i class='bx bxs-watch'></i><span>${a[b].time}</span></div>
            `,d.appendChild(c),c.addEventListener("click",()=>{deleteElementDeleteTask(),openTask(a[b].task_id),$(".detail textarea").val(a[b].note),$(".detail .task-name").text("# "+a[b].name),document.querySelectorAll(".tasks .data .list.active").forEach(a=>{a.classList.remove("active")}),c.classList.add("active");let d=document.createElement("button");d.classList.add("delete"),d.innerHTML="<i class='bx bxs-trash-alt' ></i>",d.addEventListener("click",()=>{deleteTask(a[b].task_id,a[b].name)}),document.querySelector(".detail .bottom").appendChild(d)})}void 0!==$(".tasks .data .list")[0]&&$(".tasks .data .list")[0].click()}}),$("#continue-delete-task").on("click",()=>{ipc.send("delete-task",dataTemp),$("#confirm-delete-task").modal("hide")}),$("#note-detail").on("click",a=>{a.preventDefault()}),ipc.on("count-data",(d,a)=>{console.log(a);for(let b=0;b<a.length;b++){var c=a[b].count<1?"":a[b].count;$(`.task[list-id="${a[b].list_id}"] .count`).text(c)}})